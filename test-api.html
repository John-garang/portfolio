<!DOCTYPE html>
<html>
<head><title>API Test</title></head>
<body>
<h1>API Test</h1>
<button onclick="testAPI()">Test API Connection</button>
<pre id="result"></pre>

<script>
async function testAPI() {
    const output = document.getElementById('result');
    output.textContent = 'Testing...\n';
    
    try {
        // Test articles
        const articles = await fetch('http://localhost:3000/api/articles').then(r => r.json());
        output.textContent += `✓ Articles: ${articles.length}\n`;
        
        // Test login
        const login = await fetch('http://localhost:3000/api/login', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({username: 'admin', password: 'JohnGarang@2024!SecureAdmin'})
        }).then(r => r.json());
        
        if (login.token) {
            output.textContent += `✓ Login successful\n`;
            localStorage.setItem('adminToken', login.token);
            
            // Test protected route
            const profile = await fetch('http://localhost:3000/api/profile', {
                headers: {'Authorization': `Bearer ${login.token}`}
            }).then(r => r.json());
            output.textContent += `✓ Profile: ${profile.fullName}\n`;
        } else {
            output.textContent += `✗ Login failed\n`;
        }
        
        output.textContent += '\n✓ All tests passed! Dashboard should work.';
    } catch (error) {
        output.textContent += `\n✗ Error: ${error.message}`;
    }
}
</script>
</body>
</html>
